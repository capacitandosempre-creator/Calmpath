<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CalmPath</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #020617; color: white; font-family: sans-serif; }
        .glass { background: rgba(15, 23, 42, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; }
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: flex; align-items: center; justify-content: center; z-index: 100; padding: 20px; }
    </style>
</head>
<body class="min-h-screen p-6">

    <div id="paywall" class="modal hidden">
        <div class="glass p-8 max-w-sm text-center border-t-4 border-indigo-500">
            <h3 class="text-2xl font-black mb-4">Sua jornada continua.</h3>
            <p class="text-gray-400 text-sm mb-6 leading-relaxed">
                Você utilizou suas consultas gratuitas. **Cadastre seu e-mail** para liberar o acesso ilimitado e garantir sua paz.
            </p>
            <form id="lead-form" class="space-y-4">
                <input type="email" id="user-email" required placeholder="Seu melhor e-mail" 
                       class="w-full p-4 rounded-2xl bg-gray-800 border border-gray-700 text-white outline-none focus:border-indigo-500">
                <button type="submit" class="w-full py-4 rounded-2xl bg-indigo-600 hover:bg-indigo-500 font-bold transition-all text-white shadow-lg shadow-indigo-500/40">
                    Liberar Ilimitado (R$ 9,90)
                </button>
            </form>
            <p class="text-[9px] text-slate-500 mt-6 uppercase tracking-widest text-center">Pagamento seguro via Kiwify</p>
        </div>
    </div>

    <header class="text-center pt-10">
        <h1 class="text-5xl font-black mb-2 tracking-tighter">CalmPath</h1>
        <p class="text-indigo-300 text-[10px] font-bold uppercase tracking-widest mb-8" id="counter">3 pesquisas restantes</p>
        
        <p class="max-w-md mx-auto text-gray-400 leading-relaxed mb-10">
            Filtramos o movimento do mundo para mentes neurodivergentes e pessoas com fobia social. 
            <span class="text-white font-bold">Planeje seu destino, evite o caos e recupere o controle da sua rotina.</span>
        </p>
    </header>

    <div class="max-w-md mx-auto">
        <input id="pac-input" type="text" placeholder="Qual local quer validar hoje?" 
               class="w-full p-5 rounded-3xl bg-gray-900 border border-gray-700 outline-none focus:border-indigo-500 shadow-2xl transition-all">
        
        <div id="result" class="hidden mt-8 glass p-6 border-l-4 border-emerald-500">
            <h2 id="name" class="text-xl font-bold"></h2>
            <p id="score" class="text-4xl font-black text-emerald-400 my-2"></p>
            <p id="desc" class="text-sm text-gray-400 italic">Ambiente seguro e com baixo estímulo sensorial.</p>
        </div>
    </div>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAQE_OdDTC7u5Rp7QSsTyH3bSg7BdYBeVs&libraries=places"></script>

    <script>
        let searches = parseInt(localStorage.getItem('cp_usage')) || 0;
        document.getElementById('counter').innerText = (3 - searches) + " pesquisas restantes";

        function init() {
            const input = document.getElementById('pac-input');
            const autocomplete = new google.maps.places.Autocomplete(input);

            autocomplete.addListener('place_changed', () => {
                if (searches >= 3) {
                    document.getElementById('paywall').classList.remove('hidden');
                    return;
                }

                const place = autocomplete.getPlace();
                if (!place.geometry) return;

                // Contabiliza a busca
                searches++;
                localStorage.setItem('cp_usage', searches);
                document.getElementById('counter').innerText = (3 - searches) + " pesquisas restantes";

                // Exibe resultado simulado
                const res = document.getElementById('result');
                res.classList.remove('hidden');
                document.getElementById('name').innerText = place.name;
                const score = Math.floor(Math.random() * 30) + 15;
                document.getElementById('score').innerText = score + "% de fluxo";
            });
        }

        // REDIRECIONAMENTO PARA SEU LINK DA KIWIFY
        document.getElementById('lead-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('user-email').value;
            console.log("Lead capturado:", email); // Aqui você pode salvar o lead futuramente
            window.location.href = "https://pay.kiwify.com.br/UvkAxpZ"; 
        });

        google.maps.event.addDomListener(window, 'load', init);
    </script>
</body>
</html>
